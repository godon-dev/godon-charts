name: "Setup kubernetes kind on osuosl runner"

on:
  workflow_dispatch:

jobs:
  setup_cluster:
    runs-on: [self-hosted, linux]
    steps:
      - name: Checkout
        uses: actions/checkout@v3
        with:
          fetch-depth: 0

      - name: Setup kind cluster config
        run: |
          echo "ðŸ”§ Creating KIND cluster..."
          kind create cluster \
            --config ./kind_config.yaml \
            --name godon-1-cluster \
            --kubeconfig /tmp/kind_kubeconfig.yaml \
            --wait 10m
          
          echo "âœ… KIND cluster created successfully"
          kind get clusters
          kubectl cluster-info --kubeconfig=/tmp/kind_kubeconfig.yaml
